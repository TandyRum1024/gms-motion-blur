<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>other</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Set shader
motionblurEnabled = true;
motionblurStrength = 1.0;
motionblurBaseVX = 0;
motionblurBaseVY = 0;
motionblurBaseVZ = 0;
motionblurBaseVR = 0;

scene = 0;
time = 0;
ready = false;

/// Shader related stuff
texBlueNoise = sprite_get_texture(texBluenoise64, 0);
surfTemp = -1;

// motionblur
shMotionblurNoise = shader_get_sampler_index(sh_motionblur_fullscreen, "sNoise");
shMotionblurVel = shader_get_uniform(sh_motionblur_fullscreen, "uVelocity");
shMotionblurStr = shader_get_uniform(sh_motionblur_fullscreen, "uStrength");
shMotionblurTexsize = shader_get_uniform(sh_motionblur_fullscreen, "uTexsize");
shMotionblurNoisesize = shader_get_uniform(sh_motionblur_fullscreen, "uNoisesize");
shMotionblurTime = shader_get_uniform(sh_motionblur_fullscreen, "uTime");

texture_set_stage(shMotionblurNoise, texBlueNoise);
application_surface_draw_enable(true);
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Camera related stuff
viewWid = view_wview[view_current];
viewHei = view_hview[view_current];
camX = room_width / 2;
camY = room_height / 2;
camRot = 0;
camZoom = 1;
camVx = 0;
camVy = 0;
camVz = 0;
camVr = 0;
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Init UI
iui_init();
uiShow = false;

ui2DBlurEnabled = true;
ui2DBlurStrength = "1";
ui2DBlurVX = "0";
ui2DBlurVY = "0";
ui2DBlurVZ = "0";
ui2DBlurVR = "0";
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Update camera
time++;

if (instance_exists(oGato))
{
    camVx += clamp((oGato.x - camX) * 0.12, -24, 24);
    camVy += clamp((oGato.y - camY) * 0.12, -24, 24);
}
else
    instance_create(room_width * 0.5, room_height * 0.5, oGato);

// wind stuff
camVx += dsin(time * 1.5 + 42.0 + dcos(time + 64.0) * 5.0) * 1.2 + dsin(time * 2.4 + 32.0) * 0.8;
camVy += dcos(time * 1.5 + 21.0 + dcos(time + 64.0) * 5.0) * 1.2 + dsin(time * 2.4 + 16.0) * 0.8;
camVr += dsin(time * 2.2 + 21.0 + dsin(time * 2.0 + 21.0) * 4.0) * 0.02 + dcos(time * 4.2 + 32.0) * 0.008;
camVz += dcos(time * 1.8 + 11.0 + dcos(time * 4.0 + 11.0) * 8.0) * 0.0018 + dcos(time * 4.2 + 32.0) * 0.0011;

// spring
camVr += clamp(-camRot * 0.1, -45, 45);
camVz += clamp((1.0 - camZoom) * 0.12, -0.8, 0.8);

camX += camVx;
camY += camVy;
camZoom += camVz;
camRot += camVr;
camZoom = clamp(camZoom, 0.01, 8.0);

camVx *= 0.75;
camVy *= 0.75;
camVz *= 0.90;
camVr *= 0.90;

var _invZoom = 5.0;
if (camZoom != 0.0)
    _invZoom = min(1.0 / camZoom, 10.0);

view_wview[view_current] = viewWid * _invZoom;
view_hview[view_current] = viewHei * _invZoom;
//view_xview[view_current] = camX - view_wview[view_current] * 0.5;
//view_yview[view_current] = camY - view_hview[view_current] * 0.5;
view_xview[view_current] = median(camX - view_wview[view_current] * 0.5, -120, room_width + 120);
view_yview[view_current] = median(camY - view_hview[view_current] * 0.5, -120, room_height + 120);
view_angle[view_current] = camRot;
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Exit check
if (keyboard_check_pressed(vk_escape))
{
    room_goto(rm_menu);
}
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Update UI
iui_update_io();
iui_inputX = window_mouse_get_x();
iui_inputY = window_mouse_get_y();

if (keyboard_check_pressed(vk_f1))
{
    uiShow = !uiShow;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="5">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>iui_destroy();
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="72">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>draw_background_tiled(bg2, 0, 0);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="64">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// post-processing effects
if (motionblurEnabled)
{
    // Draw screen pass with motion blur (with interpolation on)
    texture_set_interpolation(true);
    shader_set(sh_motionblur_fullscreen);
    
    // texture info
    shader_set_uniform_f(shMotionblurTexsize, surface_get_width(application_surface), surface_get_height(application_surface));
    shader_set_uniform_f(shMotionblurNoisesize, 1 / texture_get_texel_width(texBlueNoise), 1 / texture_get_texel_height(texBlueNoise));
    
    // blur info
    shader_set_uniform_f(shMotionblurTime, time);
    
    // remap the velocity so that subtle movements doesn't make a lot of blur
    var _vx = 0, _vy = 0;
    var _vxintensity = abs(camVx) - 2, _vyintensity = abs(camVy) - 2;
    if (_vxintensity &gt; 0) _vx = lerp(0, camVx, min(_vxintensity / 2, 1.0));
    if (_vyintensity &gt; 0) _vy = lerp(0, camVy, min(_vyintensity / 2, 1.0));
    
    shader_set_uniform_f(shMotionblurVel, _vx + motionblurBaseVX, _vy + motionblurBaseVY, camVz + motionblurBaseVZ, camVr + motionblurBaseVR); // set camera velocities
    shader_set_uniform_f(shMotionblurStr, motionblurStrength, motionblurStrength, motionblurStrength); // set motion blur strength
    
    // draw screen pass
    draw_surface(application_surface, 0, 0);
    shader_reset();
    texture_set_interpolation(false);
}
else
{
    draw_surface(application_surface, 0, 0);
}
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Draw GUI
var _cx = window_get_width() * 0.5;

draw_set_font(fntMenuTiny);
if (uiShow)
{
    iui_begin();
    
    draw_set_halign(0);
    
    // backdrop
    var _uilabel = $9cd6fc;
    var _uiheight = 150;
    iui_rect(0, 0, _cx * 2, _uiheight, $212020);
    iui_rect(0, _uiheight, _cx * 2, 2, c_black);
    iui_label_shadow(10, _uiheight + 2, "^ Debug menu! Press &lt;F1&gt; to hide.", _uilabel, 1, 1, 0);
    
    var _uiy = 24;
    iui_label_shadow(10, _uiy, "BLUR STRENGTH", _uilabel, 1, 1, 0);
    ui2DBlurStrength = iui_textbox_numberonly(10, _uiy + 24, 80, 24, ui2DBlurStrength, "#2D_STR");
    
    iui_label_shadow(200, _uiy, "MOTION BLUR", _uilabel, 1, 1, 0);
    ui2DBlurEnabled = iui_checkbox(200, _uiy + 24, 24, 24, ui2DBlurEnabled, "#2D_ENABLED");
    
    _uiy += 64;
    iui_label_shadow(10, _uiy, "X Vel.", _uilabel, 1, 1, 0);
    ui2DBlurVX = iui_textbox_numberonly(10, _uiy + 24, 80, 24, ui2DBlurVX, "#2D_VX");
    
    iui_label_shadow(100, _uiy, "Y Vel.", _uilabel, 1, 1, 0);
    ui2DBlurVY = iui_textbox_numberonly(100, _uiy + 24, 80, 24, ui2DBlurVY, "#2D_VY");
    
    iui_label_shadow(200, _uiy, "Zoom Vel.", _uilabel, 1, 1, 0);
    ui2DBlurVZ = iui_textbox_numberonly(200, _uiy + 24, 80, 24, ui2DBlurVZ, "#2D_VZ");
    
    iui_label_shadow(300, _uiy, "Rot. Vel.", _uilabel, 1, 1, 0);
    ui2DBlurVR = iui_textbox_numberonly(300, _uiy + 24, 80, 24, ui2DBlurVR, "#2D_VR");
    
    motionblurStrength = real(ui2DBlurStrength);
    motionblurBaseVX = real(ui2DBlurVX);
    motionblurBaseVY = real(ui2DBlurVY);
    motionblurBaseVZ = real(ui2DBlurVZ);
    motionblurBaseVR = real(ui2DBlurVR);
    
    motionblurEnabled = ui2DBlurEnabled;
    iui_end();
}
else
{
    var _infoy = 10, _infostr = "&lt;ARROW KEY&gt; to move and &lt;Z&gt; to shoot#&lt;F1&gt; for debug menu", _infocol = c_yellow;
    
    draw_set_halign(1);
    draw_text_colour(_cx + 2, _infoy + 2, _infostr, 0, 0, 0, 0, 1.0);
    draw_text_colour(_cx, _infoy, _infostr, _infocol, _infocol, _infocol, _infocol, 1.0);
}

draw_set_halign(0);
draw_text_colour(11, 11, "FPS : " + string(fps_real), 0, 0, 0, 0, 1.0);
draw_text_colour(10, 10, "FPS : " + string(fps_real), c_yellow, c_yellow, c_yellow, c_yellow, 1.0);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// surface update
// init surface n' stuff
if (!ready)
{
    ready = true;
    time = 0;
    
    viewWid = view_wview[view_current];
    viewHei = view_hview[view_current];
    
    application_surface_draw_enable(false);
    
    if (surface_exists(surfTemp)) surface_free(surfTemp);
    surfTemp = surface_create(view_wview[view_current], view_hview[view_current]);
}

// surface heartbeat
if (!surface_exists(surfTemp))
    surfTemp = surface_create(view_wview[view_current], view_hview[view_current]);
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
